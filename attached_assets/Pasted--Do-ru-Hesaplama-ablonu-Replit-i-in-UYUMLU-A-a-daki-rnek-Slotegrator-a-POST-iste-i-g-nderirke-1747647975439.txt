âœ… DoÄŸru Hesaplama Åablonu (Replit iÃ§in UYUMLU)
AÅŸaÄŸÄ±daki Ã¶rnek, Slotegrator'a POST isteÄŸi gÃ¶nderirken X-Sign baÅŸlÄ±ÄŸÄ±nÄ± doÄŸru hesaplaman iÃ§in idealdir:

ts
Kopyala
DÃ¼zenle
import crypto from "crypto";
import axios from "axios";

const secretKey = "SENIN_SECRET_KEYIN"; // Slotegrator'dan gelen secret

function getXSign(secretKey: string, requestBody: object) {
  const bodyString = JSON.stringify(requestBody);
  const toHash = secretKey + bodyString;
  const hash = crypto.createHash("sha256").update(toHash).digest("hex");
  return hash;
}

// Ã–rnek POST isteÄŸi:
const requestBody = {
  player_id: "player_123",
  game_id: "game_456",
  currency: "TRY",
  language: "en",
  return_url: "https://seninsiten.com/casino",
  mode: "real",
  ip_address: "127.0.0.1",
  device: "desktop",
  session_id: "abc123"
};

const signature = getXSign(secretKey, requestBody);

axios.post("https://api.slotegrator.com/v1/game-launch", requestBody, {
  headers: {
    "Content-Type": "application/json",
    "Authorization": "Bearer SENIN_ACCESS_TOKENIN",
    "X-Sign": signature
  }
})
.then(res => {
  console.log("âœ… BaÅŸarÄ±lÄ±:", res.data);
})
.catch(err => {
  console.error("âŒ Hata:", err.response?.data || err.message);
});
âš ï¸ En SÄ±k YapÄ±lan Hatalar
Hata	AÃ§Ä±klama
âŒ requestBody'yi stringify etmeden direkt imzalama	JSON.stringify(requestBody) ZORUNLU
âŒ Content-Type yanlÄ±ÅŸ veya eksik	"application/json" olmalÄ±
âŒ body iÃ§eriÄŸi ile gÃ¶nderilen iÃ§erik farklÄ±ysa	Ã–rn: key sÄ±rasÄ± deÄŸiÅŸirse bile hash farklÄ± olur
âŒ Slotegrator test ortamÄ± ile production karÄ±ÅŸmÄ±ÅŸ	DoÄŸru secret_key ve access_token kullanÄ±lÄ±yor mu?

ğŸ› ï¸ Replit Ã–nerisi
EÄŸer Replit'te Express kullanÄ±yorsan ve gelen callback'i imzayla doÄŸrulamak istiyorsan:

ts
Kopyala
DÃ¼zenle
app.post("/api/slotegrator/callback", express.json(), (req, res) => {
  const incomingSignature = req.headers["x-sign"];
  const calculatedSignature = getXSign(secretKey, req.body);

  if (incomingSignature !== calculatedSignature) {
    return res.status(401).json({ message: "Invalid signature" });
  }

  // Ä°mza doÄŸruysa iÅŸlemleri yap
  res.json({ status: "ok" });
});
